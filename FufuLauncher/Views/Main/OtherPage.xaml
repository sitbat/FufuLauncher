<Page
    x:Class="FufuLauncher.Views.OtherPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:helpers="using:FufuLauncher.Helpers"
    Background="Transparent">

    <Page.Resources>
        <helpers:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Page.Resources>

    <Grid>
        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="24" Margin="32">
                
                <TextBlock Text="其他设置" FontSize="28" FontWeight="SemiBold" HorizontalAlignment="Center"/>

                
                <StackPanel Orientation="Horizontal" Spacing="24">
                    
                    
                    <Grid Padding="24" CornerRadius="12" BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
                          Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" MinWidth="400">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="附加程序启动" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="12" Margin="0,0,0,16">
                            <ToggleSwitch IsOn="{x:Bind ViewModel.IsAdditionalProgramEnabled, Mode=TwoWay}"/>
                            <TextBlock Text="启动游戏时同时运行附加程序" FontSize="14" VerticalAlignment="Center" Opacity="0.8"/>
                        </StackPanel>
                        
                        <Grid Grid.Row="2" Margin="0,0,0,16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
    
                            <TextBlock Grid.Row="0" Text="程序路径" FontSize="14" Opacity="0.8"/>
                            <Grid Grid.Row="2" ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox Grid.Column="0" 
                                         Text="{x:Bind ViewModel.AdditionalProgramPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                         IsEnabled="{x:Bind ViewModel.IsAdditionalProgramEnabled, Mode=OneWay}" 
                                         PlaceholderText="输入或选择可执行文件路径..." 
                                         MinHeight="36"
                                         LostFocus="TextBox_LostFocus"
                                         KeyDown="ProgramPath_KeyDown"/>
                                
                                <Button Grid.Column="1" 
                                        Content="应用" 
                                        Command="{x:Bind ViewModel.ApplyProgramPathCommand}" 
                                        IsEnabled="{x:Bind ViewModel.IsApplyButtonEnabled, Mode=OneWay}" 
                                        MinHeight="36" 
                                        Padding="12,8"
                                        Margin="0,0,8,0"/>
                                
                                <Button Grid.Column="2" 
                                        Content="浏览..." 
                                        Command="{x:Bind ViewModel.BrowseProgramCommand}" 
                                        IsEnabled="{x:Bind ViewModel.IsAdditionalProgramEnabled, Mode=OneWay}" 
                                        MinHeight="36" 
                                        Padding="16,8"/>
                            </Grid>
                        </Grid>
                        
                        <TextBlock Grid.Row="3" Text="仅支持 .exe 格式程序&#x0a;游戏启动后自动在附加运行&#x0a;如果选择路径无反应，请手动输入路径" 
                                   FontSize="12" Opacity="0.6" TextWrapping="Wrap" Margin="0,0,0,16"/>
                        
                    </Grid>

                    
                    <Grid Padding="24" CornerRadius="12" BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" 
                          Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" MinWidth="400">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="键盘连点器" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="12" Margin="0,0,0,16">
                            <ToggleSwitch IsOn="{x:Bind ViewModel.IsAutoClickerEnabled, Mode=TwoWay}"/>
                            <TextBlock Text="启用连点器功能" FontSize="14" VerticalAlignment="Center" Opacity="0.8"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Row="2" Spacing="8" Margin="0,0,0,16">
                            <TextBlock Text="触发键 (按住开始连点，松手停止)" FontSize="14" Opacity="0.8"/>
                            <Grid ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" Text="{x:Bind ViewModel.TriggerKey, Mode=TwoWay}" 
                                         IsEnabled="{x:Bind ViewModel.IsAutoClickerEnabled, Mode=OneWay}" 
                                         PlaceholderText="点击按钮后按任意键设置" MinHeight="36" IsReadOnly="True"/>
                                <Button Grid.Column="1" Content="设置触发键" Command="{x:Bind ViewModel.RecordTriggerKeyCommand}" 
                                        IsEnabled="{x:Bind ViewModel.IsAutoClickerEnabled, Mode=OneWay}" 
                                        MinHeight="36" Padding="16,8"/>
                            </Grid>
                        </StackPanel>
                        
                        <StackPanel Grid.Row="3" Spacing="8" Margin="0,0,0,16">
                            <TextBlock Text="连点键 (被快速点击的按键)" FontSize="14" Opacity="0.8"/>
                            <Grid ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" Text="{x:Bind ViewModel.ClickKey, Mode=TwoWay}" 
                                         IsEnabled="{x:Bind ViewModel.IsAutoClickerEnabled, Mode=OneWay}" 
                                         PlaceholderText="点击按钮后按任意键设置" MinHeight="36" IsReadOnly="True"/>
                                <Button Grid.Column="1" Content="设置连点键" Command="{x:Bind ViewModel.RecordClickKeyCommand}" 
                                        IsEnabled="{x:Bind ViewModel.IsAutoClickerEnabled, Mode=OneWay}" 
                                        MinHeight="36" Padding="16,8"/>
                            </Grid>
                        </StackPanel>
                        
                        <TextBlock Grid.Row="4" Text="• 按住触发键开始连点，松开停止连点&#x0a;• 切换到其他界面后仍然有效&#x0a;• 触发键和连点键可以是任意按键" 
                                   FontSize="12" Opacity="0.6" TextWrapping="Wrap" Margin="0,0,0,16"/>
                        
                        <TextBlock Grid.Row="5" Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}" FontSize="12" 
                                   Opacity="0.7" Foreground="{ThemeResource SystemFillColorCautionBrush}" 
                                   Visibility="{x:Bind ViewModel.StatusMessage, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}"/>
                    </Grid>
                </StackPanel>

                
                <Button Content="保存设置" Command="{x:Bind ViewModel.SaveSettingsCommand}" 
                        HorizontalAlignment="Center" Style="{StaticResource AccentButtonStyle}" Padding="24,12" MinWidth="200"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>